<table class="widget widget--station-stats">
  <thead class="widget__header">
    <th colspan="2">
      <div class="flex">
        <svg><use xlink:href='#stats' /></svg>
        <div>
          <h4>
            Response Statistics
          </h4>
          <div class="timeframe">
            Last 30 days
          </div>
        </div>
      </div>
    </th>
  </thead>
  <tbody class="widget__body">
    {% set cls = cycler("odd", "even") %}
    <tr class="{{ cls.next() }}">
      <th>
        Calls
      </th>
      <td>
        {{ stats.incident_stats.num_incidents }}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th>
        Calls
        <aside>Last 365 days</aside>
      </th>
      <td>
        {{ stats.incident_stats.num_incidents_last_365_days | formatNumber }}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th>
        Reaction Time
        <aside>Median seconds</aside>
      </th>
      <td>
        {{ stats.unit_time_stats.first_unit_reaction.median }}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th rowspan=3>
        Travel Time
        <aside>Median minutes</aside>
      </th>
      <td>
        {% if stats.region_stats.central and stats.region_stats.central.num_incidents > 0 -%}
          {{ (stats.region_stats.central.unit_travel_time.median/60) | round(1) }}
          <aside>Central</aside>
        {% else %}
           --
          <aside>Central</aside>
        {% endif -%}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {% if stats.region_stats.south and stats.region_stats.south.num_incidents > 0 -%}
          {{ (stats.region_stats.south.unit_travel_time.median/60) | round(1) }}
          <aside>South</aside>
        {% else %}
           --
          <aside>South</aside>
        {% endif -%}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {% if stats.region_stats.north and stats.region_stats.north.num_incidents > 0 -%}
          {{ (stats.region_stats.north.unit_travel_time.median/60) | round(1) }}
          <aside>North</aside>
        {% else %}
           --
          <aside>North</aside>
        {% endif -%}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th>
        Responder Time on Calls
        <aside>Total minutes</aside>
      </th>
      <td>
        {{ (stats.personnel_stats.time_on_incidents.sum/60) | round | formatNumber }}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th>
        Unique Responders
      </th>
      <td>
        {{ stats.personnel_stats.num_unique_responders }}
      </td>
    </tr>
    {% if page.url !== '/' %}
    <tr class="{{ cls.next() }}">
      <th>
        Responders per Call
        <aside>Median</aside>
      </th>
      <td>
        {{ stats.personnel_stats.num_per_incidents.median | round(0, 'ceil') }}
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th rowspan=4>
        Incident Types
      </th>
      <td>
        {{ stats.incident_stats.types.medical_rescue }}
        <aside>Medical Assists</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {{ stats.incident_stats.types.fire }}
        <aside>Fire</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {{ stats.incident_stats.types.downgraded }}
        <aside>Downgraded</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {{ stats.incident_stats.types.cancelled }}
        <aside>Cancelled</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th rowspan=2>
        Time of Day
      </th>
      <td>
        {{ stats.incident_stats.num_daytime_incidents }}
        <aside>Daytime</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <td>
        {{ stats.incident_stats.num_nighttime_incidents }}
        <aside>Nighttime</aside>
      </td>
    </tr>
    <tr class="{{ cls.next() }}">
      <th>
        Simultaneous Calls
      </th>
      <td>
        {{ stats.incident_stats.num_overlapping_incidents }}
      </td>
    </tr>
    {% endif %}
  </tbody>
  {% if page.url === '/' %}
    <tfoot class="widget__foot">
      <td colspan="2">
        <a href="/about/incidents/">More Info Â»</a>
      </td>
    </tfoot>
  {% endif %}
</table>
